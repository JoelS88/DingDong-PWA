var Page=function(){return{vm:new function(){var t=this;t.character=ko.observableArray([]),t.sortName=function(e,a){var n=$(".filter-btn").not("#filter-dropdown-btn.filter-btn"),r=$(a.target);r.hasClass("active")?r.toggleClass("asc"):(n.removeClass("active asc"),r.addClass("active")),r.hasClass("asc")?t.character.sort(function(t,e){return e.name==t.name?0:e.name<t.name?-1:1}):t.character.sort(function(t,e){return t.name==e.name?0:t.name<e.name?-1:1})},t.sortWeight=function(e,a){var n=$(".filter-btn").not("#filter-dropdown-btn.filter-btn"),r=$(a.target);r.hasClass("active")?r.toggleClass("asc"):(n.removeClass("active asc"),r.addClass("active")),r.hasClass("asc")?t.character.sort(function(t,e){return e.weight-t.weight}):t.character.sort(function(t,e){return t.weight-e.weight})},t.sortDifficulty=function(e,a){var n=$(".filter-btn").not("#filter-dropdown-btn.filter-btn"),r=$(a.target);r.hasClass("active")?r.toggleClass("asc"):(n.removeClass("active asc"),r.addClass("active")),r.hasClass("asc")?t.character.sort(function(t,e){return t.maxPercent-t.minPercent-(e.maxPercent-e.minPercent)}):t.character.sort(function(t,e){return e.maxPercent-e.minPercent-(t.maxPercent-t.minPercent)})},t.sortFallspeed=function(e,a){var n=$(".filter-btn").not("#filter-dropdown-btn.filter-btn"),r=$(a.target);r.hasClass("active")?r.toggleClass("asc"):(n.removeClass("active asc"),r.addClass("active")),r.hasClass("asc")?t.character.sort(function(t,e){return e.fallspeed-t.fallspeed}):t.character.sort(function(t,e){return t.fallspeed-e.fallspeed})},t.sortGravity=function(e,a){var n=$(".filter-btn").not("#filter-dropdown-btn.filter-btn"),r=$(a.target);r.hasClass("active")?r.toggleClass("asc"):(n.removeClass("active asc"),r.addClass("active")),r.hasClass("asc")?t.character.sort(function(t,e){return e.gravity-t.gravity}):t.character.sort(function(t,e){return t.gravity-e.gravity})}},hideOfflineWarning:function(){document.querySelector("body").classList.remove("loading"),document.getElementById("notification").style.display="none"},showOfflineWarning:function(){document.querySelector("body").classList.add("loading");var t=new XMLHttpRequest;t.open("GET","./offline.html",!0),t.onload=function(){200===t.status?(document.getElementById("notification").innerHTML=t.responseText,document.getElementById("notification").style.display="block",setTimeout(function(){document.getElementById("notification").style.display="none"},3e3)):console.warn("Error retrieving offline.html")},t.onerror=function(){console.error("Connection error")},t.send()}}}(),Custom=function(){function t(e){window.jQuery?e():setTimeout(function(){t(e())},50)}t(function(){function t(t){var e=window.location.host,a=window.location.protocol+"//"+e+"/#/"+t.attr("data-url");window.location.replace(a)}function e(e){function n(t){var e=t.scrollTop();containerWidth=$("#character-list li.active .characterBorder").innerWidth(),marginOffset=$("#character-list li.active .characterBorder").css("margin-top"),120<e?($("#character-list li.active .sticky").addClass("stuck"),$(".stuck").css({top:marginOffset,width:containerWidth})):($(".stuck").css({top:0,width:"100%"}),$(".sticky").removeClass("stuck"))}function r(){var t=l.scrollTop();d!==t?(d=t,c(),s(r)):s(r)}var o=e;if(!o.hasClass("active")){o.addClass("active"),$("body").addClass("no-scroll character-active"),o.find(".characterImageContainer").hasClass("text-dark")?$("body").addClass("text-dark"):$("body").removeClass("text-dark"),$("#characterBackButton").addClass("active");var i=$(".character-box.active .characterImageContainer").css("backgroundColor");$(".characterUnderlay").css("backgroundColor",i),a(o.find(".rageBtn.active")),n($(".character-box.active .characterBorder"));var c=function(){n($(".character-box.active .characterBorder"))},s=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame||window.oRequestAnimationFrame,l=$(".character-box.active .characterBorder"),d=l.scrollTop();s&&r(),$(window).resize(function(t){n($(".character-box.active .characterBorder"))}),t(e)}}function a(t){var e=t.attr("data-rage");t.siblings(".rageBtn").removeClass("active"),t.addClass("active");var a="",n="";"50"==e&&(a=-2,n=-5),"60"==e&&(a=-5,n=-9),"80"==e&&(a=-9,n=-16),"100"==e&&(a=-12,n=-22),"125"==e&&(a=-14,n=-27),"150"==e&&(a=-18,n=-33),$(".character-box.active .stagePercents").each(function(){var t=$(this),e=t.find(".minPerc"),r=t.find(".maxPerc"),o=t.find(".percRange"),i=e.attr("data-defaultmin"),c=r.attr("data-defaultmax"),s=parseInt(i)+a,l=parseInt(c)+n,d=l-(s=Math.max(0,s))+1;l<s?(console.log("dingdong is impossible!"),e.text("N/A").addClass("nosymbol"),r.text("N/A").addClass("nosymbol"),o.text("-").addClass("nosymbol")):(e.removeClass("nosymbol"),r.removeClass("nosymbol"),o.removeClass("nosymbol"),e.prop("number",e.text()).animateNumber({number:s},200),r.prop("number",r.text()).animateNumber({number:l},200),o.prop("number",o.text()).animateNumber({number:d},200))})}function n(t){$("body").hasClass("active-character")&&s(),$("body").addClass("no-scroll").removeClass("text-dark"),$(".characterUnderlay").css("backgroundColor","rgb(136,136,136)"),$("#characterBackButton").addClass("active"),$("#"+t).show()}function r(t){a(t.is(":last-child")?t.siblings(".rageBtn:first-child"):t.next())}function o(t){a(t.is(":first-child")?t.siblings(".rageBtn:last-child"):t.prev())}function i(t){s(),e(t.is(":last-child")?t.siblings(".character-box:first-child"):t.next())}function c(t){s(),e(t.is(":first-child")?t.siblings(".character-box:last-child"):$(t.prev()))}function s(){var t=$("body");$("#characterBackButton").removeClass("active"),t.removeClass("no-scroll"),t.hasClass("character-active")?($("#character-list li.active .rageModifier").removeClass("stuck"),$("#character-list li.active .characterBorder").css("height","auto"),$("#character-list li.active").removeClass("active"),t.removeClass("character-active")):$(".menu-page > div").hide();var e=window.location.protocol+"//"+window.location.host+"/#/";console.log(e),window.location.replace(e)}!function(){var t=window.location.protocol+"//"+window.location.host+"/",a=$(location).attr("href");if(console.log("base url is "+t+" and current url is "+a),t!=a&&t+"#"!=a&&t+"#/"!=a){console.log("urls do not match!");var r=a.split("/"),o=r[r.length-1];if("about"==(o=o.toLowerCase()))console.log("about activated!"),n("page-about");else if("credits"==o)console.log("credits activated!"),n("page-credits");else{var i=$("."+String(o)).closest(".character-box");i.length?e(i):(console.log("This character does not exist, yo"),$("#notification").html("Looks like this character does not exist.<br>Please check the URL.").show(),$("#notification").delay(3e3).fadeOut())}}}();var l=!1;$(document).keyup(function(t){16==t.which&&(l=!1)}).keydown(function(t){("key"in(t=t||window.event)?"Escape"==t.key||"Esc"==t.key:27==t.keyCode)&&($("body").hasClass("no-scroll")?s():$("body").toggleClass("toggle-sidedrawer")),16==t.which&&(l=!0),$(".character-box.active").length&&(l?(39==t.which&&r($(".character-box.active .rageBtn.active")),37==t.which&&o($(".character-box.active .rageBtn.active"))):(39==t.which&&i($(".character-box.active")),37==t.which&&c($(".character-box.active")),49==t.which&&a($(".character-box.active .rageBtn:nth-child(1)")),50==t.which&&a($(".character-box.active .rageBtn:nth-child(2)")),51==t.which&&a($(".character-box.active .rageBtn:nth-child(3)")),52==t.which&&a($(".character-box.active .rageBtn:nth-child(4)")),53==t.which&&a($(".character-box.active .rageBtn:nth-child(5)")),54==t.which&&a($(".character-box.active .rageBtn:nth-child(6)")),55==t.which&&a($(".character-box.active .rageBtn:nth-child(7)"))))}),$(".filter-toggle").click(function(){var t=$(this);if(t.toggleClass("active"),t.next(".btn-group.mobile").toggleClass("active"),$("#main").toggleClass("filtersActive"),$("#main").hasClass("filtersActive")){var e=$(window).scrollTop(),a=$("header").height()+$(".btn-group.mobile.active").innerHeight();e<140?$("#main").css("margin-top",a):$("#main").css("margin-top","")}else $("#main").css("margin-top","")}),$(".sidedrawer-toggle, #sidedrawer-overlay").click(function(){$("body").toggleClass("toggle-sidedrawer")}),$("#main").on("click",".character-box",function(){e($(this))}),$("#main").on("click",".rageBtn",function(){a($(this))}),$("#icon-next").click(function(){i($(".character-box.active"))}),$("#icon-prev").click(function(){c($(".character-box.active"))}),$("#characterBackButton").click(function(){s()}),$("#about").click(function(){n("page-about")}),$("#credits").click(function(){n("page-credits")}),$("#filter-dropdown-btn").click(function(){$this=$(this),$this.toggleClass("active"),$this.closest(".btn-group").toggleClass("open")}),$(".add-info-grid").click(function(){$(".add-info-grid").toggleClass("checked"),$("body").toggleClass("show-extra-info")})})},characters=function(){function t(){var t=this;t.name="",t.url="",t.bgColour="",t.weight="",t.difficulty="",t.minPercent="",t.maxPercent="",t.percRange="",t.fallspeed="",t.gravity="",t.airdodgeStart="",t.airdodgeEnd="",t.imagePosition="",t.textContrast=""}function e(){var e=this;e.toCharacterViewModel=function(e){if(e){var a=new t;return a.name=e.name,a.bgColour=e.bgColour,a.weight=e.weight,a.fallspeed=e.fallspeed,a.gravity=e.gravity,a.url=e.url,a.minPercent=parseInt(e.minPercent),a.maxPercent=parseInt(e.maxPercent),a.percRange=ko.computed(function(){return a.maxPercent-a.minPercent},this),a.difficulty=ko.computed(function(){var t=a.maxPercent-a.minPercent,e="";return 0<=t&&t<=6&&(e="very-hard"),7<=t&&t<=11&&(e="hard"),12<=t&&t<=22&&(e="average"),23<=t&&t<=30&&(e="easy"),31<=t&&(e="very-easy"),e},this),a.difficultyValue=ko.computed(function(){var t=a.fallspeed*a.gravity,e=a.weight/t;return Math.ceil(e)},this),a.airdodgeStart=e.airdodgeStart,a.airdodgeEnd=e.airdodgeEnd,a.imagePosition=e.imagePosition,a.textContrast=e.textContrast,a.imageProperties=ko.observable(a.url+" "+a.imagePosition+" "+a.textContrast),a.fd=a.minPercent,a.bfNormalMin=ko.computed(function(){return a.minPercent+7},this),a.bfNormalMax=ko.computed(function(){return a.maxPercent+7},this),a.bfLowPlatMin=ko.computed(function(){return a.minPercent-7},this),a.bfLowPlatMax=ko.computed(function(){return a.maxPercent+7},this),a.bfTopPlatMin=ko.computed(function(){return a.minPercent-20},this),a.bfTopPlatMax=ko.computed(function(){return a.maxPercent+7},this),a.dlNormalMin=a.minPercent,a.dlNormalMax=a.maxPercent,a.dlLowPlatMin=ko.computed(function(){return a.minPercent-15},this),a.dlLowPlatMax=ko.computed(function(){return a.maxPercent},this),a.dlTopPlatMin=ko.computed(function(){return a.minPercent-26},this),a.dlTopPlatMax=ko.computed(function(){return a.maxPercent},this),a.svNormalMin=ko.computed(function(){return a.minPercent+1},this),a.svNormalMax=ko.computed(function(){return a.maxPercent+1},this),a.svPlatMin=ko.computed(function(){return a.minPercent-14},this),a.svPlatMax=ko.computed(function(){return a.maxPercent+1},this),a.tcNormalMin=ko.computed(function(){return a.minPercent-4},this),a.tcNormalMax=ko.computed(function(){return a.maxPercent},this),a.tcLowPlatMin=ko.computed(function(){return a.minPercent-20},this),a.tcLowPlatMax=ko.computed(function(){return a.maxPercent},this),a.tcSidePlatMin=ko.computed(function(){return a.minPercent-25},this),a.tcSidePlatMax=ko.computed(function(){return a.maxPercent},this),a.tcTopPlatMin=ko.computed(function(){return a.minPercent-41},this),a.tcTopPlatMax=ko.computed(function(){return a.maxPercent},this),a}return null},e.toCharacterViewModels=function(t){return t&&t.length>0?t.map(function(t){return e.toCharacterViewModel(t)}):[]}}var a=new function(t,e){this.getAll=function(){return t.getAll().then(function(t){return e.toCharacterViewModels(t)})}}(new function(){this.getAll=function(){return new Promise(function(t,e){var a=new XMLHttpRequest;a.open("GET","./api/data.json"),a.onload=function(){if(200===a.status){var n="";n=JSON.parse(a.response),t(n)}else e(Error(a.statusText))},a.onerror=function(){e(Error("Network Error"))},a.send()})}},e=new e);return{loadData:function(){a.getAll().then(function(t){Page.vm.character(t),document.getElementById("body").classList.remove("loading"),Custom()})}}}();"serviceWorker"in navigator&&navigator.serviceWorker.register("./sw.js").then(function(t){console.log("Successfully registered service worker",t)}).catch(function(t){console.warn("Error while registering service worker",t)}),window.addEventListener("online",function(t){console.log("You are online"),Page.hideOfflineWarning(),characters.loadData()},!1),window.addEventListener("offline",function(t){console.log("You are offline"),Page.showOfflineWarning()},!1),navigator.onLine?characters.loadData():Page.showOfflineWarning(),ko.applyBindings(Page.vm);