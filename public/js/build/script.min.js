function computeDifficulty(a,t){var e=t-a,n="";return 0<=e&&e<=6&&(n="very-hard"),7<=e&&e<=11&&(n="hard"),12<=e&&e<=22&&(n="average"),23<=e&&e<=30&&(n="easy"),31<=e&&(n="very-easy"),n}var Page=function(){return{vm:new function(){function a(){console.log("reindexing!"),$(".character-box").each(function(){var a=$(this),t=parseInt(a.index());a.find(".grid-index span").text(t+1)})}var t=this;t.character=ko.observableArray([]),a(),t.sortName=function(e,n){var r=$(".filter-btn").not("#filter-dropdown-btn.filter-btn"),i=$(n.target);i.hasClass("active")?i.toggleClass("asc"):(r.removeClass("active asc"),i.addClass("active")),i.hasClass("asc")?t.character.sort(function(a,t){return t.name==a.name?0:t.name<a.name?-1:1}):(t.character.sort(function(a,t){return a.name==t.name?0:a.name<t.name?-1:1}),a())},t.sortWeight=function(e,n){var r=$(".filter-btn").not("#filter-dropdown-btn.filter-btn"),i=$(n.target);i.hasClass("active")?i.toggleClass("asc"):(r.removeClass("active asc"),i.addClass("active")),i.hasClass("asc")?t.character.sort(function(a,t){return t.weight-a.weight}):(t.character.sort(function(a,t){return a.weight-t.weight}),a())},t.sortDifficulty=function(e,n){var r=$(".filter-btn").not("#filter-dropdown-btn.filter-btn"),i=$(n.target);i.hasClass("active")?i.toggleClass("asc"):(r.removeClass("active asc"),i.addClass("active")),i.hasClass("asc")?t.character.sort(function(a,t){return a.maxPercent-a.minPercent-(t.maxPercent-t.minPercent)}):(t.character.sort(function(a,t){return t.maxPercent-t.minPercent-(a.maxPercent-a.minPercent)}),a())},t.sortFallspeed=function(e,n){var r=$(".filter-btn").not("#filter-dropdown-btn.filter-btn"),i=$(n.target);i.hasClass("active")?i.toggleClass("asc"):(r.removeClass("active asc"),i.addClass("active")),i.hasClass("asc")?t.character.sort(function(a,t){return t.fallspeed-a.fallspeed}):(t.character.sort(function(a,t){return a.fallspeed-t.fallspeed}),a())},t.sortGravity=function(e,n){var r=$(".filter-btn").not("#filter-dropdown-btn.filter-btn"),i=$(n.target);i.hasClass("active")?i.toggleClass("asc"):(r.removeClass("active asc"),i.addClass("active")),i.hasClass("asc")?t.character.sort(function(a,t){return t.gravity-a.gravity}):(t.character.sort(function(a,t){return a.gravity-t.gravity}),a())}},hideOfflineWarning:function(){document.querySelector("body").classList.remove("loading"),document.getElementById("notification").style.display="none"},showOfflineWarning:function(){var a=new XMLHttpRequest;a.open("GET","./offline.html",!0),a.onload=function(){200===a.status?(document.getElementById("notification").innerHTML=a.responseText,document.getElementById("notification").style.display="block",setTimeout(function(){document.getElementById("notification").style.display="none"},3e3)):console.warn("Error retrieving offline.html")},a.onerror=function(){console.error("Connection error")},a.send()}}}(),Custom=function(){function a(e){window.jQuery?$.getJSON("./api/data.json",function(a){t=a,e()}).fail(function(){console.log("error retrieving data")}):setTimeout(function(){a(e())},50)}var t;a(function(){function a(a){var t=window.location.host,e=window.location.protocol+"//"+t+"/#/"+a.attr("data-url");window.location.replace(e)}function e(a){$(".character-box").each(function(){$(this).find(".characterTitleBar span").text().toLowerCase().indexOf(a)>=0?$(this).show():$(this).hide()})}function n(a){var t=a.scrollTop();containerWidth=g.innerWidth(),marginOffset=g.css("margin-top"),120<t?($("#characterModal .sticky").addClass("stuck"),$(".stuck").css({top:marginOffset,width:containerWidth}),$(".stickyName").slideDown("fast")):($(".stuck").css({top:0,width:"100%"}),$(".sticky").removeClass("stuck"),$(".stickyName").hide())}function r(){var a=p.scrollTop();x!==a?(x=a,m(),v(r)):v(r)}function i(e){e.addClass("selected"),$("body").addClass("no-scroll character-active");var r=e.closest(".character-box.selected").data("index"),i=$("#characterModal");i.find(".characterImageContainer").attr("class","characterImageContainer"),i.removeClass("animate");var s=t[r].name,o=t[r].url,l=t[r].bgColour,d=t[r].weight,f=parseInt(t[r].minPercent),h=parseInt(t[r].maxPercent),u=t[r].fallspeed,m=t[r].gravity,v=t[r].airdodgeStart,p=t[r].airdodgeEnd,x=t[r].textContrast,b=v+" - "+p,w=h-f+1;i.addClass("active"),x&&i.addClass(x),i.addClass(o),$("#character-underlay").css("backgroundColor",l),i.find(".characterImageContainer, .stickyName").css("backgroundColor",l);var C=function(a){return document.getElementById(a)};$("#characterModalImage");C("characterModal").offsetWidth=C("characterModal").offsetWidth,C("characterModal").classList.add("animate"),i.find(".grid-percRange .minPerc").text(f),i.find(".grid-percRange .maxPerc").text(h),i.find('span[data-ref="name"], .stickyName').text(s);var y=computeDifficulty(f,h);i.find(".grid-difficulty").html('<span class="'+y+'">'+y+" - "+w+"%</span>"),i.find(".characterName").text(s);var k=i.find(".characterOverview");k.find('li[data-ref="weight"]').html('Weight<span class="value">'+d+"</span>"),k.find('li[data-ref="fallspeed"]').html('Fallspeed<span class="value">'+u+"</span>"),k.find('li[data-ref="airdodge"]').html('Airdodge<span class="value">'+b+"</span>"),k.find('li[data-ref="gravity"]').html('Gravity<span class="value">'+m+"</span>");var P=i.find(".stage-fd");P.find('span[data-ref="minPerc"]').text(f).attr("data-defaultmin",f),P.find('span[data-ref="maxPerc"]').text(h).attr("data-defaultmax",h);var M=i.find(".stage-bf");M.find('span[data-ref="bfNormalMin"]').text(f+7).attr("data-defaultmin",f+7),M.find('span[data-ref="bfNormalMax"]').text(h).attr("data-defaultmax",h),M.find('span[data-ref="bfLowPlatMin"]').text(f-7).attr("data-defaultmin",f-7),M.find('span[data-ref="bfLowPlatMax"]').text(h).attr("data-defaultmax",h),M.find('span[data-ref="bfTopPlatMin"]').text(f-20).attr("data-defaultmin",f-20),M.find('span[data-ref="bfTopPlatMax"]').text(h).attr("data-defaultmax",h);var B=i.find(".stage-dl");B.find('span[data-ref="dlNormalMin"]').text(f).attr("data-defaultmin",f),B.find('span[data-ref="dlNormalMax"]').text(h).attr("data-defaultmax",h),B.find('span[data-ref="dlLowPlatMin"]').text(f-15).attr("data-defaultmin",f-15),B.find('span[data-ref="dlLowPlatMax"]').text(h).attr("data-defaultmax",h),B.find('span[data-ref="dlTopPlatMin"]').text(f-26).attr("data-defaultmin",f-26),B.find('span[data-ref="dlTopPlatMax"]').text(h).attr("data-defaultmax",h);var N=i.find(".stage-sv");N.find('span[data-ref="svNormalMin"]').text(f+1).attr("data-defaultmin",f+1),N.find('span[data-ref="svNormalMax"]').text(h).attr("data-defaultmax",h),N.find('span[data-ref="svPlatMin"]').text(f-14).attr("data-defaultmin",f-14),N.find('span[data-ref="svPlatMax"]').text(h).attr("data-defaultmax",h);var E=i.find(".stage-tc");E.find('span[data-ref="tcNormalMin"]').text(f-4).attr("data-defaultmin",f-4),E.find('span[data-ref="tcNormalMax"]').text(h).attr("data-defaultmax",h),E.find('span[data-ref="tcLowPlatMin"]').text(f-20).attr("data-defaultmin",f-20),E.find('span[data-ref="tcLowPlatMax"]').text(h).attr("data-defaultmax",h),E.find('span[data-ref="tcSidePlatMin"]').text(f-25).attr("data-defaultmin",f-25),E.find('span[data-ref="tcSidePlatMax"]').text(h).attr("data-defaultmax",h),E.find('span[data-ref="tcTopPlatMin"]').text(f-41).attr("data-defaultmin",f-41),E.find('span[data-ref="tcTopPlatMax"]').text(h).attr("data-defaultmax",h),c(i.find(".rageBtn.active")),$(window).resize(function(a){n(g)}),a(e)}function s(){var a=$("body");if(a.removeClass("no-scroll"),$("#character-underlay").css("backgroundColor","transparent"),a.hasClass("character-active")){var t=$("#characterModal");t.removeClass(),t.find(".rageModifier").removeClass("stuck"),t.find(".characterBorder").css("height","auto"),$("#character-list li.selected").removeClass("selected"),a.removeClass("character-active")}else $(".menu-page > div").hide(),$("#sidedrawer-underlay").css("backgroundColor","transparent"),$("#menuBackButton").removeClass("active");var e=window.location.protocol+"//"+window.location.host+"/#/";window.location.replace(e)}function o(){$("#characterModal").attr("class","active"),$("#character-list li.selected").removeClass("selected")}function c(a){var t=a.attr("data-rage");a.siblings(".rageBtn").removeClass("active"),a.addClass("active");var e="",n="";"50"==t&&(e=-2,n=-5),"60"==t&&(e=-5,n=-9),"80"==t&&(e=-9,n=-16),"100"==t&&(e=-12,n=-22),"125"==t&&(e=-14,n=-27),"150"==t&&(e=-18,n=-33),$("#characterModal .stagePercents").each(function(){var a=$(this),t=a.find(".minPerc"),r=a.find(".maxPerc"),i=a.find(".percRange"),s=t.attr("data-defaultmin"),o=r.attr("data-defaultmax"),c=parseInt(s)+e,l=parseInt(o)+n,d=l-(c=Math.max(0,c))+1;l<c?(console.log("dingdong is impossible!"),t.text("N/A").addClass("nosymbol"),r.text("N/A").addClass("nosymbol"),i.text("-").addClass("nosymbol")):(t.removeClass("nosymbol"),r.removeClass("nosymbol"),i.removeClass("nosymbol"),t.prop("number",t.text()).animateNumber({number:c},200),r.prop("number",r.text()).animateNumber({number:l},200),i.prop("number",i.text()).animateNumber({number:d},200))})}function l(a){$("body").hasClass("active-character")&&s(),$("body").addClass("no-scroll").removeClass("text-dark"),$("#sidedrawer-underlay").css("backgroundColor","rgb(136,136,136)"),$("#menuBackButton").addClass("active"),$("#"+a).show()}function d(a){c(a.is(":last-child")?a.siblings(".rageBtn:first-child"):a.next())}function f(a){c(a.is(":first-child")?a.siblings(".rageBtn:last-child"):a.prev())}function h(a){var t=$(a);t.siblings(".character-box").is(":visible")&&(t.nextAll(".character-box").is(":visible")?(o(),i(t.nextAll(".character-box:visible").first())):(o(),i(t.siblings(".character-box:visible").first())))}function u(a){var t=$(a);t.siblings(".character-box").is(":visible")&&(t.prevAll(".character-box").is(":visible")?(o(),i(t.prevAll(".character-box:visible").first())):(o(),i(t.siblings(".character-box:visible").last())))}!function(){var a=window.location.protocol+"//"+window.location.host+"/",t=$(location).attr("href");if(console.log("base url is "+a+" and current url is "+t),a!=t&&a+"#"!=t&&a+"#/"!=t&&!(t.indexOf("homescreen")>-1)){console.log("urls do not match!");var e=t.split("/"),n=e[e.length-1];if("about"==n)l("page-about");else if("credits"==n)l("page-credits");else{var r=String(e[e.length-1]),s=$(".character-box[data-url="+r+"]");s.length?i(s):(console.log("This character does not exist, yo"),$("#notification").html("Looks like this character does not exist.<br>Please check the URL.").show(),$("#notification").delay(3e3).fadeOut())}}}(),$("#search").keyup(function(){var a=$(this).val().toLowerCase();$searchbox=$(this).closest(".search-box"),""==$(this).val()?(console.log("does not have value"),$searchbox.removeClass("active")):(console.log("has value"),$(this).closest(".search-box").addClass("active")),e(a)}),$(".search-box .clear-input").click(function(){$(".search-box #search").val("").closest(".search-box").removeClass("active"),e("")});var g=$("#characterModal .characterContainer"),m=function(){n(g)},v=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame||window.oRequestAnimationFrame,p=g,x=p.scrollTop();v&&r(),n(g);var b=!1;$(document).keyup(function(a){16==a.which&&(b=!1)}).keydown(function(a){if(("key"in(a=a||window.event)?"Escape"==a.key||"Esc"==a.key:27==a.keyCode)&&($("body").hasClass("no-scroll")?s():$("body").toggleClass("toggle-sidedrawer")),16==a.which&&(b=!0),$("#characterModal.active").length){var t=$(this);b?(39==a.which&&d(t.find(".rageBtn.active")),37==a.which&&f(t.find(".rageBtn.active"))):(39==a.which&&h($(".character-box.selected")),37==a.which&&u($(".character-box.selected")),49==a.which&&c(t.find(".rageBtn:nth-child(1)")),50==a.which&&c(t.find(".rageBtn:nth-child(2)")),51==a.which&&c(t.find(".rageBtn:nth-child(3)")),52==a.which&&c(t.find(".rageBtn:nth-child(4)")),53==a.which&&c(t.find(".rageBtn:nth-child(5)")),54==a.which&&c(t.find(".rageBtn:nth-child(6)")),55==a.which&&c(t.find(".rageBtn:nth-child(7)")))}}),$(".filter-toggle").click(function(){var a=$(this);if(a.toggleClass("active"),a.next(".btn-group.mobile").toggleClass("active"),$("#main").toggleClass("filtersActive"),$("#main").hasClass("filtersActive")){var t=$(window).scrollTop(),e=$("header").height()+$(".btn-group.mobile.active").innerHeight();t<140?$("#main").css("margin-top",e):$("#main").css("margin-top","")}else $("#main").css("margin-top","")}),$(".sidedrawer-toggle, #sidedrawer-overlay").click(function(){$("body").toggleClass("toggle-sidedrawer")}),$("#main").on("click","#character-list .character-box",function(){i($(this))}),$("#characterModal").on("click",".rageBtn",function(){c($(this))}),$("#icon-next").click(function(){h($(".character-box.selected"))}),$("#icon-prev").click(function(){u($(".character-box.selected"))}),$(".backButton").click(function(){s()}),$("#about").click(function(){l("page-about")}),$("#credits").click(function(){l("page-credits")}),$("#filter-dropdown-btn").click(function(){$this=$(this),$this.toggleClass("active"),$this.closest(".btn-group").toggleClass("open")}),$(".add-extra-info").click(function(){$this=$(this),$this.closest(".btn-group").hasClass("mobile")?$this.hasClass("checked")?($this.removeClass("checked"),$("body").removeClass("show-ledgeFsmash show-extra-info")):($(".mobile .add-extra-info").removeClass("checked"),$this.addClass("checked"),$this.hasClass("add-info-grid")&&$("body").addClass("show-extra-info").removeClass("show-ledgeFsmash"),$this.hasClass("add-ledgeFsmash-grid")&&$("body").addClass("show-ledgeFsmash").removeClass("show-extra-info")):($this.hasClass("add-info-grid")&&($this.toggleClass("checked"),$("body").toggleClass("show-extra-info")),$this.hasClass("add-ledgeFsmash-grid")&&($this.toggleClass("checked"),$("body").toggleClass("show-ledgeFsmash")))})})},characters=function(){function a(){var a=this;a.id="",a.name="",a.url="",a.bgColour="",a.weight="",a.difficulty="",a.minPercent="",a.maxPercent="",a.percRange="",a.fallspeed="",a.gravity="",a.airdodgeStart="",a.airdodgeEnd="",a.imagePosition="",a.textContrast="",a.ledgeFsmash=""}function t(){var t=this;t.toCharacterViewModel=function(t){if(t){var e=new a;return e.id=parseInt(t.id),e.name=t.name,e.bgColour=t.bgColour,e.weight=t.weight,e.fallspeed=t.fallspeed,e.gravity=t.gravity,e.url=t.url,e.minPercent=parseInt(t.minPercent),e.maxPercent=parseInt(t.maxPercent),e.percRange=ko.computed(function(){var a=e.maxPercent-e.minPercent;return++a},this),e.difficulty=computeDifficulty(e.minPercent,e.maxPercent),e.difficultyValue=ko.computed(function(){var a=e.fallspeed*e.gravity,t=e.weight/a;return Math.ceil(t)},this),e.airdodgeStart=t.airdodgeStart,e.airdodgeEnd=t.airdodgeEnd,t.imagePosition?e.imagePosition=t.imagePosition:e.imagePosition="",t.textContrast?e.textContrast=t.textContrast:e.textContrast="",e.imageProperties=ko.observable(e.url+" "+e.imagePosition+" "+e.textContrast),t.ledgeFsmash?e.ledgeFsmash="yes":e.ledgeFsmash="no",e}return null},t.toCharacterViewModels=function(a){return a&&a.length>0?a.map(function(a){return t.toCharacterViewModel(a)}):[]}}var e=new function(a,t){this.getAll=function(){return a.getAll().then(function(a){return t.toCharacterViewModels(a)})}}(new function(){this.getAll=function(){return new Promise(function(a,t){var e=new XMLHttpRequest;e.open("GET","./api/data.json"),e.onload=function(){if(200===e.status){var t="";t=JSON.parse(e.response),a(t)}},e.onerror=function(){t(Error("Network Error"))},e.send()})}},t=new t);return{loadData:function(){e.getAll().then(function(a){Page.vm.character(a),document.getElementById("body").classList.remove("loading"),Custom()})}}}();"serviceWorker"in navigator&&window.addEventListener("load",function(){navigator.serviceWorker.register("./service-worker.js?v2").then(function(a){a.onupdatefound=function(){var t=a.installing;t.onstatechange=function(){switch(t.state){case"installed":navigator.serviceWorker.controller?console.log("New or updated content is available."):console.log("Content is now available offline!");break;case"redundant":console.error("The installing service worker became redundant.")}}}}).catch(function(a){console.error("Error during service worker registration:",a)})}),window.addEventListener("online",function(a){console.log("You are online"),Page.hideOfflineWarning()},!1),window.addEventListener("offline",function(a){console.log("You are offline"),Page.showOfflineWarning()},!1),navigator.onLine?characters.loadData():(characters.loadData(),Page.showOfflineWarning()),ko.applyBindings(Page.vm);