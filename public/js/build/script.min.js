function computeDifficulty(a,t){var e=t-a,n="";return 0<=e&&e<=6&&(n="very-hard"),7<=e&&e<=11&&(n="hard"),12<=e&&e<=22&&(n="average"),23<=e&&e<=30&&(n="easy"),31<=e&&(n="very-easy"),n}var Page=function(){return{vm:new function(){var a=this;a.character=ko.observableArray([]),a.sortName=function(t,e){var n=$(".filter-btn").not("#filter-dropdown-btn.filter-btn"),r=$(e.target);r.hasClass("active")?r.toggleClass("asc"):(n.removeClass("active asc"),r.addClass("active")),r.hasClass("asc")?a.character.sort(function(a,t){return t.name==a.name?0:t.name<a.name?-1:1}):a.character.sort(function(a,t){return a.name==t.name?0:a.name<t.name?-1:1})},a.sortWeight=function(t,e){var n=$(".filter-btn").not("#filter-dropdown-btn.filter-btn"),r=$(e.target);r.hasClass("active")?r.toggleClass("asc"):(n.removeClass("active asc"),r.addClass("active")),r.hasClass("asc")?a.character.sort(function(a,t){return t.weight-a.weight}):a.character.sort(function(a,t){return a.weight-t.weight})},a.sortDifficulty=function(t,e){var n=$(".filter-btn").not("#filter-dropdown-btn.filter-btn"),r=$(e.target);r.hasClass("active")?r.toggleClass("asc"):(n.removeClass("active asc"),r.addClass("active")),r.hasClass("asc")?a.character.sort(function(a,t){return a.maxPercent-a.minPercent-(t.maxPercent-t.minPercent)}):a.character.sort(function(a,t){return t.maxPercent-t.minPercent-(a.maxPercent-a.minPercent)})},a.sortFallspeed=function(t,e){var n=$(".filter-btn").not("#filter-dropdown-btn.filter-btn"),r=$(e.target);r.hasClass("active")?r.toggleClass("asc"):(n.removeClass("active asc"),r.addClass("active")),r.hasClass("asc")?a.character.sort(function(a,t){return t.fallspeed-a.fallspeed}):a.character.sort(function(a,t){return a.fallspeed-t.fallspeed})},a.sortGravity=function(t,e){var n=$(".filter-btn").not("#filter-dropdown-btn.filter-btn"),r=$(e.target);r.hasClass("active")?r.toggleClass("asc"):(n.removeClass("active asc"),r.addClass("active")),r.hasClass("asc")?a.character.sort(function(a,t){return t.gravity-a.gravity}):a.character.sort(function(a,t){return a.gravity-t.gravity})}},hideOfflineWarning:function(){document.querySelector("body").classList.remove("loading"),document.getElementById("notification").style.display="none"},showOfflineWarning:function(){var a=new XMLHttpRequest;a.open("GET","./offline.html",!0),a.onload=function(){200===a.status?(document.getElementById("notification").innerHTML=a.responseText,document.getElementById("notification").style.display="block",setTimeout(function(){document.getElementById("notification").style.display="none"},3e3)):console.warn("Error retrieving offline.html")},a.onerror=function(){console.error("Connection error")},a.send()}}}(),Custom=function(){function a(t){window.jQuery?t():setTimeout(function(){a(t())},50)}a(function(){function a(a){var t=a.scrollTop();containerWidth=f.innerWidth(),marginOffset=f.css("margin-top"),120<t?($("#characterModal .sticky").addClass("stuck"),$(".stuck").css({top:marginOffset,width:containerWidth}),$(".stickyName").slideDown("fast")):($(".stuck").css({top:0,width:"100%"}),$(".sticky").removeClass("stuck"),$(".stickyName").hide())}function t(){var a=m.scrollTop();g!==a?(g=a,h(),u(t)):u(t)}function e(t){t.addClass("selected"),$("body").addClass("no-scroll character-active");var e=t.closest(".character-box.selected").data("index"),n=$("#characterModal");n.find(".characterImageContainer").attr("class","characterImageContainer"),n.removeClass("animate");var r=v[e].name,s=v[e].url,o=v[e].bgColour,c=v[e].weight,d=parseInt(v[e].minPercent),l=parseInt(v[e].maxPercent),h=v[e].fallspeed,u=v[e].gravity,m=v[e].airdodgeStart,g=v[e].airdodgeEnd,p=v[e].textContrast,C=m+" - "+g,x=l-d+1;n.addClass("active"),p&&n.addClass(p),n.addClass(s),$(".modalUnderlay").css("backgroundColor",o),n.find(".characterImageContainer, .stickyName").css("backgroundColor",o);var w=function(a){return document.getElementById(a)};$("#characterModalImage");w("characterModal").offsetWidth=w("characterModal").offsetWidth,w("characterModal").classList.add("animate"),n.find(".grid-percRange .minPerc").text(d),n.find(".grid-percRange .maxPerc").text(l),n.find('span[data-ref="name"], .stickyName').text(r);var b=computeDifficulty(d,l);n.find(".grid-difficulty").html('<span class="'+b+'">'+b+" - "+x+"%</span>"),n.find(".characterName").text(r);var y=n.find(".characterOverview");y.find('li[data-ref="weight"]').html('Weight<span class="value">'+c+"</span>"),y.find('li[data-ref="fallspeed"]').html('Gravity<span class="value">'+h+"</span>"),y.find('li[data-ref="airdodge"]').html('Airdodge<span class="value">'+C+"</span>"),y.find('li[data-ref="gravity"]').html('Gravity<span class="value">'+u+"</span>");var k=n.find(".stage-fd");k.find('span[data-ref="minPerc"]').text(d).attr("data-defaultmin",d),k.find('span[data-ref="maxPerc"]').text(l).attr("data-defaultmax",l);var P=n.find(".stage-bf");P.find('span[data-ref="bfNormalMin"]').text(d+7).attr("data-defaultmin",d+7),P.find('span[data-ref="bfNormalMax"]').text(l).attr("data-defaultmax",l),P.find('span[data-ref="bfLowPlatMin"]').text(d-7).attr("data-defaultmin",d-7),P.find('span[data-ref="bfLowPlatMax"]').text(l).attr("data-defaultmax",l),P.find('span[data-ref="bfTopPlatMin"]').text(d-20).attr("data-defaultmin",d-20),P.find('span[data-ref="bfTopPlatMax"]').text(l).attr("data-defaultmax",l);var M=n.find(".stage-dl");M.find('span[data-ref="dlNormalMin"]').text(d).attr("data-defaultmin",d),M.find('span[data-ref="dlNormalMax"]').text(l).attr("data-defaultmax",l),M.find('span[data-ref="dlLowPlatMin"]').text(d-15).attr("data-defaultmin",d-15),M.find('span[data-ref="dlLowPlatMax"]').text(l).attr("data-defaultmax",l),M.find('span[data-ref="dlTopPlatMin"]').text(d-26).attr("data-defaultmin",d-26),M.find('span[data-ref="dlTopPlatMax"]').text(l).attr("data-defaultmax",l);var B=n.find(".stage-sv");B.find('span[data-ref="svNormalMin"]').text(d+1).attr("data-defaultmin",d+1),B.find('span[data-ref="svNormalMax"]').text(l).attr("data-defaultmax",l),B.find('span[data-ref="svPlatMin"]').text(d-14).attr("data-defaultmin",d-14),B.find('span[data-ref="svPlatMax"]').text(l).attr("data-defaultmax",l);var N=n.find(".stage-tc");N.find('span[data-ref="tcNormalMin"]').text(d-4).attr("data-defaultmin",d-4),N.find('span[data-ref="tcNormalMax"]').text(l).attr("data-defaultmax",l),N.find('span[data-ref="tcLowPlatMin"]').text(d-20).attr("data-defaultmin",d-20),N.find('span[data-ref="tcLowPlatMax"]').text(l).attr("data-defaultmax",l),N.find('span[data-ref="tcSidePlatMin"]').text(d-25).attr("data-defaultmin",d-25),N.find('span[data-ref="tcSidePlatMax"]').text(l).attr("data-defaultmax",l),N.find('span[data-ref="tcTopPlatMin"]').text(d-41).attr("data-defaultmin",d-41),N.find('span[data-ref="tcTopPlatMax"]').text(l).attr("data-defaultmax",l),i(n.find(".rageBtn.active")),$(window).resize(function(t){a(f)})}function n(){var a=$("body");if(a.removeClass("no-scroll"),$(".modalUnderlay").css("backgroundColor","transparent"),a.hasClass("character-active")){var t=$("#characterModal");t.removeClass(),t.find(".rageModifier").removeClass("stuck"),t.find(".characterBorder").css("height","auto"),$("#character-list li.selected").removeClass("selected"),a.removeClass("character-active")}else $(".menu-page > div").hide(),$("#menuBackButton").removeClass("active")}function r(){$("#characterModal").attr("class","active"),$("#character-list li.selected").removeClass("selected")}function i(a){var t=a.attr("data-rage");a.siblings(".rageBtn").removeClass("active"),a.addClass("active");var e="",n="";"50"==t&&(e=-2,n=-5),"60"==t&&(e=-5,n=-9),"80"==t&&(e=-9,n=-16),"100"==t&&(e=-12,n=-22),"125"==t&&(e=-14,n=-27),"150"==t&&(e=-18,n=-33),$("#characterModal .stagePercents").each(function(){var a=$(this),t=a.find(".minPerc"),r=a.find(".maxPerc"),i=a.find(".percRange"),s=t.attr("data-defaultmin"),o=r.attr("data-defaultmax"),c=parseInt(s)+e,d=parseInt(o)+n,l=d-(c=Math.max(0,c))+1;d<c?(console.log("dingdong is impossible!"),t.text("N/A").addClass("nosymbol"),r.text("N/A").addClass("nosymbol"),i.text("-").addClass("nosymbol")):(t.removeClass("nosymbol"),r.removeClass("nosymbol"),i.removeClass("nosymbol"),t.prop("number",t.text()).animateNumber({number:c},200),r.prop("number",r.text()).animateNumber({number:d},200),i.prop("number",i.text()).animateNumber({number:l},200))})}function s(a){$("body").hasClass("active-character")&&n(),$("body").addClass("no-scroll").removeClass("text-dark"),$(".modalUnderlay").css("backgroundColor","rgb(136,136,136)"),$("#menuBackButton").addClass("active"),$("#"+a).show()}function o(a){i(a.is(":last-child")?a.siblings(".rageBtn:first-child"):a.next())}function c(a){i(a.is(":first-child")?a.siblings(".rageBtn:last-child"):a.prev())}function d(a){r(),e(a.is(":last-child")?a.siblings(".character-box:first-child"):a.next())}function l(a){r(),e(a.is(":first-child")?a.siblings(".character-box:last-child"):$(a.prev()))}jQuery("#character-list .character-box").each(function(){var a=$(this).index();$(this).attr("data-index",a)});var f=$("#characterModal .characterContainer"),h=function(){a(f)},u=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame||window.oRequestAnimationFrame,m=f,g=m.scrollTop();u&&t(),a(f);var v;$.getJSON("./api/data.json",function(a){v=a}).fail(function(){console.log("error retrieving data")});var p=!1;$(document).keyup(function(a){16==a.which&&(p=!1)}).keydown(function(a){if(("key"in(a=a||window.event)?"Escape"==a.key||"Esc"==a.key:27==a.keyCode)&&($("body").hasClass("no-scroll")?n():$("body").toggleClass("toggle-sidedrawer")),16==a.which&&(p=!0),$("#characterModal.active").length){var t=$(this);p?(39==a.which&&o(t.find(".rageBtn.active")),37==a.which&&c(t.find(".rageBtn.active"))):(39==a.which&&d($(".character-box.selected")),37==a.which&&l($(".character-box.selected")),49==a.which&&i(t.find(".rageBtn:nth-child(1)")),50==a.which&&i(t.find(".rageBtn:nth-child(2)")),51==a.which&&i(t.find(".rageBtn:nth-child(3)")),52==a.which&&i(t.find(".rageBtn:nth-child(4)")),53==a.which&&i(t.find(".rageBtn:nth-child(5)")),54==a.which&&i(t.find(".rageBtn:nth-child(6)")),55==a.which&&i(t.find(".rageBtn:nth-child(7)")))}}),$(".filter-toggle").click(function(){var a=$(this);if(a.toggleClass("active"),a.next(".btn-group.mobile").toggleClass("active"),$("#main").toggleClass("filtersActive"),$("#main").hasClass("filtersActive")){var t=$(window).scrollTop(),e=$("header").height()+$(".btn-group.mobile.active").innerHeight();t<140?$("#main").css("margin-top",e):$("#main").css("margin-top","")}else $("#main").css("margin-top","")}),$(".sidedrawer-toggle, #sidedrawer-overlay").click(function(){$("body").toggleClass("toggle-sidedrawer")}),$("#main").on("click","#character-list .character-box",function(){e($(this))}),$("#characterModal").on("click",".rageBtn",function(){i($(this))}),$("#icon-next").click(function(){d($(".character-box.selected"))}),$("#icon-prev").click(function(){l($(".character-box.selected"))}),$(".backButton").click(function(){n()}),$("#about").click(function(){s("page-about")}),$("#credits").click(function(){s("page-credits")}),$("#filter-dropdown-btn").click(function(){$this=$(this),$this.toggleClass("active"),$this.closest(".btn-group").toggleClass("open")}),$(".add-extra-info").click(function(){$this=$(this),$this.closest(".btn-group").hasClass("mobile")?$this.hasClass("checked")?($this.removeClass("checked"),$("body").removeClass("show-ledgeFsmash show-extra-info")):($(".mobile .add-extra-info").removeClass("checked"),$this.addClass("checked"),$this.hasClass("add-info-grid")&&$("body").addClass("show-extra-info").removeClass("show-ledgeFsmash"),$this.hasClass("add-ledgeFsmash-grid")&&$("body").addClass("show-ledgeFsmash").removeClass("show-extra-info")):($this.hasClass("add-info-grid")&&($this.toggleClass("checked"),$("body").toggleClass("show-extra-info")),$this.hasClass("add-ledgeFsmash-grid")&&($this.toggleClass("checked"),$("body").toggleClass("show-ledgeFsmash")))})})},characters=function(){function a(){var a=this;a.name="",a.url="",a.bgColour="",a.weight="",a.difficulty="",a.minPercent="",a.maxPercent="",a.percRange="",a.fallspeed="",a.gravity="",a.airdodgeStart="",a.airdodgeEnd="",a.imagePosition="",a.textContrast="",a.ledgeFsmash=""}function t(){var t=this;t.toCharacterViewModel=function(t){if(t){var e=new a;return e.name=t.name,e.bgColour=t.bgColour,e.weight=t.weight,e.fallspeed=t.fallspeed,e.gravity=t.gravity,e.url=t.url,e.minPercent=parseInt(t.minPercent),e.maxPercent=parseInt(t.maxPercent),e.percRange=ko.computed(function(){var a=e.maxPercent-e.minPercent;return++a},this),e.difficulty=computeDifficulty(e.minPercent,e.maxPercent),e.difficultyValue=ko.computed(function(){var a=e.fallspeed*e.gravity,t=e.weight/a;return Math.ceil(t)},this),e.airdodgeStart=t.airdodgeStart,e.airdodgeEnd=t.airdodgeEnd,t.imagePosition?e.imagePosition=t.imagePosition:e.imagePosition="",t.textContrast?e.textContrast=t.textContrast:e.textContrast="",e.imageProperties=ko.observable(e.url+" "+e.imagePosition+" "+e.textContrast),t.ledgeFsmash?e.ledgeFsmash="yes":e.ledgeFsmash="no",e}return null},t.toCharacterViewModels=function(a){return a&&a.length>0?a.map(function(a){return t.toCharacterViewModel(a)}):[]}}var e=new function(a,t){this.getAll=function(){return a.getAll().then(function(a){return t.toCharacterViewModels(a)})}}(new function(){this.getAll=function(){return new Promise(function(a,t){var e=new XMLHttpRequest;e.open("GET","./api/data.json"),e.onload=function(){if(200===e.status){var t="";t=JSON.parse(e.response),a(t)}},e.onerror=function(){t(Error("Network Error"))},e.send()})}},t=new t);return{loadData:function(){e.getAll().then(function(a){Page.vm.character(a),document.getElementById("body").classList.remove("loading"),Custom()})}}}();"serviceWorker"in navigator&&window.addEventListener("load",function(){navigator.serviceWorker.register("./service-worker.js?v2").then(function(a){a.onupdatefound=function(){var t=a.installing;t.onstatechange=function(){switch(t.state){case"installed":navigator.serviceWorker.controller?console.log("New or updated content is available."):console.log("Content is now available offline!");break;case"redundant":console.error("The installing service worker became redundant.")}}}}).catch(function(a){console.error("Error during service worker registration:",a)})}),window.addEventListener("online",function(a){console.log("You are online"),Page.hideOfflineWarning(),characters.loadData()},!1),window.addEventListener("offline",function(a){console.log("You are offline"),Page.showOfflineWarning()},!1),navigator.onLine?characters.loadData():(characters.loadData(),Page.showOfflineWarning()),ko.applyBindings(Page.vm);